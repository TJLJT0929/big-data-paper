# 基于LendingClub平台数据的贷款违约预测研究

---

**摘要：** 随着互联网金融的迅速发展，P2P网络借贷平台面临着日益严峻的信用风险管理挑战。本文以美国最大的P2P借贷平台LendingClub为研究对象，基于其2007年至今公开的贷款数据集（约39.6万条记录、28个特征变量），运用探索性数据分析（EDA）、数据预处理、特征工程等方法对贷款违约的影响因素进行深入分析，并分别构建了人工神经网络（ANN）、XGBoost和随机森林（Random Forest）三种机器学习模型，对借款人是否违约进行预测。研究结果表明：贷款利率、贷款等级、债务收入比（DTI）、贷款期限等是影响违约的关键因素；在三种模型中，人工神经网络模型表现最优，测试集ROC-AUC得分达到0.905，XGBoost次之（0.734），随机森林为0.725。本研究为P2P平台的风险评估与贷款审批决策提供了数据驱动的理论依据和实践参考。

**关键词：** P2P网络借贷；贷款违约预测；LendingClub；机器学习；探索性数据分析；人工神经网络；XGBoost；随机森林

---

## 一、引言

### 1.1 研究背景

近年来，互联网金融（FinTech）的蓬勃发展深刻改变了传统金融服务的模式与格局。其中，P2P（Peer-to-Peer）网络借贷作为互联网金融的重要组成部分，通过搭建线上平台直接连接资金供给方与需求方，显著降低了融资成本，提高了资金配置效率。LendingClub（借贷俱乐部）成立于2006年，总部位于美国旧金山，是全球最大的P2P借贷平台之一。它是首家在美国证券交易委员会（SEC）注册其产品为证券的P2P借贷机构，也是第一家在二级市场上提供贷款交易的平台，主要提供个人贷款、商业贷款和医疗融资等服务。

然而，P2P借贷模式在降低信息不对称的同时，也面临着严峻的信用风险管理挑战。对于借贷平台而言，信用风险主要体现在两个方面：一是将贷款发放给有能力偿还的借款人而被拒绝审批，将导致平台业务损失；二是将贷款发放给无力偿还的违约借款人，将直接导致平台和投资者的经济损失。因此，如何准确识别潜在的违约借款人，构建有效的信用风险评估模型，成为P2P借贷平台亟需解决的核心问题。

### 1.2 研究现状

国内外学者围绕贷款违约预测问题开展了大量研究。在传统方法方面，Logistic回归模型因其可解释性强、计算效率高等优点，长期以来一直是信用评分领域的主流方法（Thomas et al., 2002）。然而，传统统计模型在处理高维、非线性特征关系时存在局限性。

随着机器学习技术的快速发展，越来越多的研究者尝试将先进的机器学习算法应用于信用风险评估。Lessmann等（2015）对多种分类算法在信用评分中的表现进行了系统比较，发现集成学习方法（如随机森林、梯度提升树等）通常优于单一分类器。Xia等（2017）提出了一种基于XGBoost的信用评分模型，在LendingClub数据集上取得了良好的预测效果。近年来，深度学习方法也逐步被引入到信用评估领域，Kvamme等（2018）研究表明，人工神经网络在捕捉复杂非线性特征关系方面具有显著优势。

在P2P借贷领域的研究中，LendingClub公开数据集因其数据量大、特征丰富、质量较高等优点，被广泛用于信用风险建模研究。Serrano-Cinca和Gutiérrez-Nieto（2016）利用LendingClub数据分析了贷款违约的关键影响因素，指出贷款等级、利率和借款人收入是重要的预测变量。Malekipirbazari和Aksakalli（2015）比较了多种机器学习方法在LendingClub数据上的分类性能，随机森林模型在多数评价指标上表现优异。

尽管已有研究取得了一定成果，但在以下方面仍存在改进空间：（1）多数研究仅使用单一或少量模型，缺乏传统机器学习模型与深度学习模型的全面比较；（2）在数据预处理和特征工程方面，不同研究的处理策略差异较大，对异常值检测与处理的关注不够充分；（3）对类别不平衡问题的处理缺乏系统性讨论。

### 1.3 研究目的与意义

基于上述研究背景与现状，本文以LendingClub平台的贷款数据为研究对象，旨在实现以下研究目标：

1. 通过全面的探索性数据分析（EDA），揭示贷款违约的主要影响因素及其分布特征；
2. 采用系统的数据预处理和特征工程方法，构建高质量的建模数据集；
3. 分别构建人工神经网络（ANN）、XGBoost和随机森林三种机器学习模型，对贷款违约进行预测，并对三种模型的性能进行全面比较分析；
4. 为P2P借贷平台的信用风险评估和贷款审批决策提供数据驱动的参考依据。

本研究的理论意义在于丰富了P2P网络借贷信用风险评估的方法论体系，通过将深度学习模型与传统机器学习模型进行对比分析，为该领域的模型选择提供参考。实践意义在于研究成果可为LendingClub等P2P借贷平台的风险管控和决策优化提供数据支撑和策略建议。

---

## 二、数据来源与分析方法

### 2.1 数据来源

本研究所使用的数据集名为"All Lending Club loan data"，来源于全球知名数据科学竞赛平台Kaggle（https://www.kaggle.com/datasets/wordsforthewise/lending-club/data）。该数据集收录了LendingClub平台2007年至今被接受和被拒绝的贷款数据，涵盖了平台运营以来的完整贷款记录。

数据集共包含约396,030条贷款记录和28个特征变量，数据规模较大，能够充分反映LendingClub平台的贷款业务特征。每条记录对应一笔贷款申请，目标变量为贷款状态（`loan_status`），分为"Fully Paid"（完全还清）和"Charged Off"（违约核销）两类。在原始数据中，完全还清的贷款占比约80.38%，违约核销的贷款占比约19.62%，呈现出明显的类别不平衡特征。

### 2.2 数据特征描述

数据集包含的28个特征变量可分为以下三大类：

**（1）借款人基本信息特征**

| 变量名 | 描述 |
|--------|------|
| `emp_title` | 借款人提供的职位名称 |
| `emp_length` | 就业年限（0-10年，10表示十年及以上） |
| `home_ownership` | 住房所有权状况（RENT租房/OWN自有/MORTGAGE抵押/OTHER其他） |
| `annual_inc` | 借款人自报年收入 |
| `verification_status` | 收入验证状态 |
| `address` | 借款人地址 |
| `earliest_cr_line` | 借款人最早信用额度开立月份 |

**（2）贷款属性特征**

| 变量名 | 描述 |
|--------|------|
| `loan_amnt` | 贷款申请金额 |
| `term` | 贷款期限（36个月或60个月） |
| `int_rate` | 贷款利率 |
| `installment` | 月还款金额 |
| `grade` | LendingClub分配的贷款等级（A-G） |
| `sub_grade` | LendingClub分配的贷款子等级 |
| `issue_d` | 贷款发放月份 |
| `purpose` | 借款人提供的贷款用途类别 |
| `title` | 借款人提供的贷款标题 |
| `initial_list_status` | 贷款的初始上市状态（W/F） |
| `application_type` | 申请类型（个人/联合申请） |

**（3）借款人信用状况特征**

| 变量名 | 描述 |
|--------|------|
| `dti` | 债务收入比（月债务支出/月收入） |
| `open_acc` | 借款人信用档案中的开放信用额度数 |
| `pub_rec` | 不良公共记录数 |
| `revol_bal` | 循环信用总余额 |
| `revol_util` | 循环信用利用率 |
| `total_acc` | 借款人信用档案中的总信用额度数 |
| `mort_acc` | 抵押贷款账户数 |
| `pub_rec_bankruptcies` | 公共记录中的破产次数 |

### 2.3 研究方法与技术路线

本研究的技术路线分为以下四个阶段：

**第一阶段：探索性数据分析（Exploratory Data Analysis, EDA）**

采用描述性统计分析、可视化分析（直方图、箱线图、热力图、计数图等）和相关性分析等方法，全面了解数据的分布特征、变量间关系及与目标变量的关联程度。具体包括：
- 目标变量分布分析
- 各特征变量的单变量分析与双变量分析
- 特征间相关性分析（Pearson相关系数热力图）
- 各数值型特征与目标变量的相关性排序分析

**第二阶段：数据预处理与特征工程**

- **缺失值处理：** 对于缺失比例较小的特征（如`revol_util`、`pub_rec_bankruptcies`，缺失率<0.5%），直接删除含缺失值的记录；对于缺失比例较大的特征（如`mort_acc`），采用基于相关特征（`total_acc`）的分组均值填充策略。
- **特征删除：** 删除唯一值过多、对建模无意义或存在信息泄漏的特征（`emp_title`、`emp_length`、`title`、`issue_d`等）。
- **异常值处理：** 基于EDA分析结果，在训练集中移除明显异常值（如年收入超过250,000、DTI超过50、开放信用额度超过40等）。
- **特征编码：** 对类别型变量进行独热编码（One-Hot Encoding），包括`sub_grade`、`verification_status`、`purpose`、`initial_list_status`、`application_type`、`home_ownership`、`zip_code`等。
- **特征转换：** 将`term`从字符串转换为数值型，从`address`中提取邮编信息，从`earliest_cr_line`中提取年份信息。
- **数据标准化：** 使用MinMaxScaler对所有特征进行归一化处理，将数据缩放至[0,1]区间。

**第三阶段：模型构建与训练**

数据集按67:33的比例划分为训练集（264,796条）和测试集（130,423条）。经异常值处理后，训练集保留262,143条记录，最终特征维度为79维。本研究构建了以下三种模型：

（1）**人工神经网络（Artificial Neural Network, ANN）：** 采用Keras框架搭建前馈神经网络，网络结构包含3个隐藏层（每层150个神经元），激活函数为ReLU，输出层使用Sigmoid激活函数。训练过程中采用BatchNormalization进行批标准化，使用Dropout（率为0.1）进行正则化以防止过拟合。优化器为Adam（学习率0.001），损失函数为二元交叉熵（Binary Cross-entropy），训练20个epoch，batch size为32。

（2）**XGBoost分类器：** 使用XGBoost库中的XGBClassifier，采用默认超参数进行训练。XGBoost是一种基于梯度提升框架的集成学习方法，通过顺序构建多棵决策树，每棵新树学习前一棵树的残差，最终集成所有树的预测结果。

（3）**随机森林分类器（Random Forest Classifier）：** 使用Scikit-learn库中的RandomForestClassifier，设置100棵决策树（`n_estimators=100`）。随机森林通过Bootstrap采样和随机特征选择构建多棵决策树，并通过投票机制进行最终分类。

**第四阶段：模型评估与比较**

采用以下评价指标对三种模型进行全面评估：
- **准确率（Accuracy）：** 正确分类的样本比例
- **精确率（Precision）：** 预测为正类中实际为正类的比例
- **召回率（Recall）：** 实际正类中被正确预测的比例
- **F1-Score：** 精确率和召回率的调和平均值
- **ROC-AUC得分：** ROC曲线下面积，综合反映模型的分类能力
- **混淆矩阵（Confusion Matrix）：** 直观展示模型的分类结果

### 2.4 实验环境

本研究使用的主要工具和库包括：
- **编程语言：** Python 3
- **数据处理：** Pandas、NumPy
- **数据可视化：** Matplotlib、Seaborn、hvPlot
- **机器学习：** Scikit-learn（RandomForestClassifier、MinMaxScaler等）、XGBoost
- **深度学习：** TensorFlow / Keras
- **运行平台：** Kaggle Notebook

---

## 三、研究结论与分析结果

### 3.1 探索性数据分析结果

#### 3.1.1 目标变量分布

对目标变量`loan_status`的分布进行统计分析，结果显示：在全部贷款记录中，"Fully Paid"（完全还清）的贷款占绝大多数（约80.38%），"Charged Off"（违约核销）的贷款占比约19.62%。这种类别不平衡现象在信用风险预测中普遍存在，需要在后续建模过程中予以关注。

> **【图1：贷款状态分布柱状图】**
> *（此处插入loan_status分布计数柱状图）*

#### 3.1.2 特征相关性分析

通过Pearson相关系数热力图分析各数值型特征间的相关关系，得到以下关键发现：

- **贷款金额（`loan_amnt`）与月还款额（`installment`）之间存在近乎完美的正相关**（相关系数接近1.0），这在业务逻辑上是合理的，因为月还款额直接由贷款金额、利率和期限决定。因此在建模时需注意这一冗余信息。
- **贷款金额与贷款利率**之间存在正相关关系，表明金额较大的贷款通常伴随更高的利率。
- **开放信用额度数（`open_acc`）与总信用额度数（`total_acc`）**之间存在较强的正相关。
- **抵押贷款账户数（`mort_acc`）与总信用额度数（`total_acc`）**的相关性最高，这一发现被后续缺失值填充策略所利用。

> **【图2：特征相关性热力图】**
> *（此处插入Pearson相关系数热力图）*

#### 3.1.3 贷款金额与月还款额分析

对贷款金额和月还款额按贷款状态进行分层分析发现：
- 违约贷款（Charged Off）的贷款金额中位数和均值均略高于全额偿还（Fully Paid）的贷款，表明贷款金额较高可能增加违约风险。
- 月还款额与贷款金额呈现同样的分布趋势。

> **【图3：贷款金额与月还款额按贷款状态的分布图】**
> *（此处插入loan_amnt和installment的直方图和箱线图）*

#### 3.1.4 贷款等级与子等级分析

LendingClub根据借款人的信用状况将贷款分为A（最优）到G（最差）七个等级。分析结果表明：

- **从A等级到G等级，违约率呈明显递增趋势。** A等级贷款的违约比例最低，而F和G等级贷款的违约比例最高。
- 在F和G子等级中，违约贷款（Charged Off）的数量与全额偿还（Fully Paid）的数量差距明显缩小，部分子等级的违约率甚至接近50%。
- 这说明LendingClub的贷款评级系统对违约风险具有较好的区分能力，等级越低，违约风险越高。

> **【图4：按贷款等级和子等级划分的贷款状态分布图】**
> *（此处插入grade和sub_grade按loan_status的计数图）*

> **【图5：F和G等级贷款的违约分布图】**
> *（此处插入F和G等级贷款的详细子等级分布图）*

#### 3.1.5 贷款期限、住房状况、验证状态与贷款用途分析

- **贷款期限（`term`）：** 60个月期限的贷款违约率显著高于36个月期限的贷款，表明较长的贷款期限增加了违约风险。
- **住房所有权状况（`home_ownership`）：** 租房（RENT）和抵押贷款（MORTGAGE）类别的借款人数量最多。各住房状况类别的违约率差异不大，但"OTHER"类别样本量极少。研究中将"ANY"和"NONE"类别合并到"OTHER"中。
- **收入验证状态（`verification_status`）：** 收入已验证（Verified）和来源已验证（Source Verified）的借款人违约比例与未验证（Not Verified）的借款人相近，收入验证对违约预测的区分度有限。
- **贷款用途（`purpose`）：** 债务合并（debt_consolidation）是最常见的贷款用途，其次是信用卡还款（credit_card）。不同贷款用途的违约率存在一定差异。

> **【图6：贷款期限、住房状况、验证状态与贷款用途按贷款状态的分布图】**
> *（此处插入term、home_ownership、verification_status和purpose的计数图）*

#### 3.1.6 利率与年收入分析

- **贷款利率（`int_rate`）：** 违约贷款的利率分布明显偏向高利率区间。这说明高利率贷款的违约风险更高，利率是预测违约的重要因子之一。
- **年收入（`annual_inc`）：** 年收入低于250,000美元的借款人占绝大多数。年收入超过1,000,000美元的借款人仅75人（不足总量的0.02%），年收入超过250,000美元的借款人共4,077人。高收入借款人的违约率相对较低。

> **【图7：利率按贷款状态的分布直方图】**
> *（此处插入int_rate按loan_status的直方图）*

> **【图8：年收入按贷款状态的分布直方图】**
> *（此处插入annual_inc按loan_status的直方图）*

#### 3.1.7 债务收入比与循环信用分析

- **债务收入比（`dti`）：** DTI值较高的借款人违约风险有所增加。DTI超过50的极端值较少（仅少量记录），在建模时将其作为异常值处理。
- **循环信用利用率（`revol_util`）：** 较高的循环信用利用率与更高的违约风险相关。利用率超过120%的记录极少，作为异常值处理。
- **循环信用余额（`revol_bal`）：** 余额超过250,000美元的记录极少，其中也包含违约记录。

> **【图9：DTI和循环信用利用率按贷款状态的分布图】**
> *（此处插入dti和revol_util按loan_status的直方图）*

#### 3.1.8 公共记录与破产记录分析

- **公共不良记录（`pub_rec`）：** 绝大多数借款人无不良公共记录（pub_rec=0），有不良记录的借款人违约率略高。
- **破产记录（`pub_rec_bankruptcies`）：** 与公共不良记录类似，绝大多数借款人无破产记录，有破产记录的借款人违约风险略有升高。
- 研究中将不良记录和破产记录转化为二值变量（0或1），简化了特征表示。

> **【图10：公共记录、初始上市状态、申请类型、破产记录和抵押贷款账户按贷款状态的分布图】**
> *（此处插入pub_rec、initial_list_status、application_type、pub_rec_bankruptcies和mort_acc的计数图）*

#### 3.1.9 数值特征与目标变量的相关性

通过计算所有数值型特征与目标变量（`loan_status`）的Pearson相关系数并进行排序，结果显示：

- **与违约正相关的特征（相关系数为正，即该特征值越大越倾向于全额偿还）：** 无明显强正相关特征，但抵押贷款账户数、年收入等与还清贷款呈微弱正相关。
- **与违约负相关的特征（相关系数为负，即该特征值越大越倾向于违约）：** 利率（`int_rate`）是最显著的负相关特征，其次是贷款期限（`term`）、债务收入比（`dti`）等。

> **【图11：数值特征与贷款状态的相关系数条形图】**
> *（此处插入各数值型特征与loan_status相关系数的水平条形图）*

### 3.2 数据预处理结果

#### 3.2.1 缺失值处理

原始数据集中存在缺失值的特征及处理方式如表所示：

| 特征 | 缺失数量 | 缺失比例 | 处理方式 |
|------|----------|----------|----------|
| `emp_title` | 较多 | — | 删除该特征（唯一值过多，不适合编码） |
| `emp_length` | 较多 | — | 删除该特征（各就业年限的违约率几乎一致） |
| `title` | 少量 | — | 删除该特征（与`purpose`信息重复） |
| `mort_acc` | 较多 | — | 按`total_acc`分组均值填充 |
| `revol_util` | 少量 | <0.5% | 删除含缺失值的行 |
| `pub_rec_bankruptcies` | 少量 | <0.5% | 删除含缺失值的行 |

经缺失值处理后，数据集保留了绝大部分记录，信息损失极小。

#### 3.2.2 特征工程

最终经过特征工程处理后，数据集包含79个特征维度（含独热编码生成的虚拟变量），具体操作包括：

- 将`term`由字符串（" 36 months"/" 60 months"）转换为数值（36/60）；
- 删除`grade`特征（因`sub_grade`包含了`grade`的全部信息）；
- 对`sub_grade`、`verification_status`、`purpose`、`initial_list_status`、`application_type`、`home_ownership`进行独热编码（drop_first=True以避免多重共线性）；
- 从`address`中提取邮政编码并进行独热编码；
- 删除`issue_d`特征（防止数据泄漏）；
- 从`earliest_cr_line`中提取年份信息；
- 将`pub_rec`、`mort_acc`、`pub_rec_bankruptcies`转化为二值变量。

#### 3.2.3 异常值处理

在训练集中，根据EDA阶段的分析结果，采用以下规则移除异常值：

| 过滤条件 | 说明 |
|----------|------|
| `annual_inc` ≤ 250,000 | 移除极端高收入样本 |
| `dti` ≤ 50 | 移除极端高债务收入比样本 |
| `open_acc` ≤ 40 | 移除极端多开放信用账户样本 |
| `total_acc` ≤ 80 | 移除极端多总信用账户样本 |
| `revol_util` ≤ 120 | 移除极端高循环信用利用率样本 |
| `revol_bal` ≤ 250,000 | 移除极端高循环信用余额样本 |

异常值移除仅在训练集上执行，测试集保持原始分布不变，以更真实地评估模型的泛化能力。处理后训练集从264,796条减少至262,143条，仅移除了约1.0%的样本。

### 3.3 模型预测结果

#### 3.3.1 人工神经网络（ANN）模型结果

ANN模型在训练集和测试集上的分类结果如下：

**训练集结果：**

| 指标 | 违约类（0） | 全额偿还类（1） | 总体准确率 |
|------|-------------|-----------------|-----------|
| 精确率（Precision） | 0.95 | 0.88 | — |
| 召回率（Recall） | 0.46 | 0.99 | — |
| F1-Score | 0.62 | 0.93 | — |
| **准确率（Accuracy）** | — | — | **88.84%** |

训练集混淆矩阵：

|  | 预测违约 | 预测偿还 |
|--|---------|---------|
| **实际违约** | 23,680 | 27,985 |
| **实际偿还** | 1,281 | 209,197 |

**测试集结果：**

| 指标 | 违约类（0） | 全额偿还类（1） | 总体准确率 |
|------|-------------|-----------------|-----------|
| 精确率（Precision） | 0.94 | 0.88 | — |
| 召回率（Recall） | 0.46 | 0.99 | — |
| F1-Score | 0.62 | 0.93 | — |
| **准确率（Accuracy）** | — | — | **88.87%** |

测试集混淆矩阵：

|  | 预测违约 | 预测偿还 |
|--|---------|---------|
| **实际违约** | 11,682 | 13,798 |
| **实际偿还** | 724 | 104,219 |

> **【图12：ANN模型训练过程中的损失与AUC演化曲线】**
> *（此处插入训练/验证损失曲线和AUC演化曲线图）*

ANN模型的训练集与测试集准确率非常接近（88.84% vs. 88.87%），未出现明显过拟合。模型对全额偿还类（Fully Paid）的识别能力优异（召回率0.99），但对违约类（Charged Off）的召回率较低（0.46），反映出类别不平衡对模型的影响。**ANN模型的ROC-AUC得分为0.905，是三种模型中表现最优的。**

#### 3.3.2 XGBoost分类器结果

**训练集结果：**

| 指标 | 违约类（0） | 全额偿还类（1） | 总体准确率 |
|------|-------------|-----------------|-----------|
| 精确率（Precision） | 0.95 | 0.89 | — |
| 召回率（Recall） | 0.50 | 0.99 | — |
| F1-Score | 0.65 | 0.94 | — |
| **准确率（Accuracy）** | — | — | **89.60%** |

训练集混淆矩阵：

|  | 预测违约 | 预测偿还 |
|--|---------|---------|
| **实际违约** | 25,828 | 25,837 |
| **实际偿还** | 1,423 | 209,055 |

**测试集结果：**

| 指标 | 违约类（0） | 全额偿还类（1） | 总体准确率 |
|------|-------------|-----------------|-----------|
| 精确率（Precision） | 0.91 | 0.89 | — |
| 召回率（Recall） | 0.48 | 0.99 | — |
| F1-Score | 0.63 | 0.94 | — |
| **准确率（Accuracy）** | — | — | **88.94%** |

> **【图13：XGBoost模型的混淆矩阵与ROC曲线】**
> *（此处插入XGBoost模型的混淆矩阵和ROC曲线图）*

XGBoost模型的训练准确率（89.60%）略高于测试准确率（88.94%），泛化能力良好。违约类的召回率（0.48-0.50）略优于ANN模型，但ROC-AUC得分为0.734，低于ANN模型。

#### 3.3.3 随机森林分类器结果

**训练集结果：**

| 指标 | 违约类（0） | 全额偿还类（1） | 总体准确率 |
|------|-------------|-----------------|-----------|
| 精确率（Precision） | 1.00 | 1.00 | — |
| 召回率（Recall） | 1.00 | 1.00 | — |
| F1-Score | 1.00 | 1.00 | — |
| **准确率（Accuracy）** | — | — | **100.00%** |

训练集混淆矩阵：

|  | 预测违约 | 预测偿还 |
|--|---------|---------|
| **实际违约** | 51,665 | 0 |
| **实际偿还** | 0 | 210,478 |

**测试集结果：**

| 指标 | 违约类（0） | 全额偿还类（1） | 总体准确率 |
|------|-------------|-----------------|-----------|
| 精确率（Precision） | 0.96 | 0.88 | — |
| 召回率（Recall） | 0.46 | 0.99 | — |
| F1-Score | 0.62 | 0.94 | — |
| **准确率（Accuracy）** | — | — | **88.94%** |

> **【图14：随机森林模型的混淆矩阵与ROC曲线】**
> *（此处插入随机森林模型的混淆矩阵和ROC曲线图）*

随机森林模型在训练集上达到了100%的准确率，但测试集准确率为88.94%，训练集与测试集之间存在明显差距，表明模型出现了过拟合现象。ROC-AUC得分为0.725，是三种模型中最低的。

#### 3.3.4 模型综合比较

三种模型在测试集上的ROC-AUC得分汇总如下：

| 模型 | 训练集准确率 | 测试集准确率 | 测试集ROC-AUC |
|------|-------------|-------------|--------------|
| 人工神经网络（ANN） | 88.84% | 88.87% | **0.905** |
| XGBoost | 89.60% | 88.94% | 0.734 |
| 随机森林 | 100.00% | 88.94% | 0.725 |

> **【图15：三种模型ROC-AUC得分对比柱状图】**
> *（此处插入三种模型训练集和测试集ROC-AUC得分的对比柱状图）*

从ROC-AUC指标来看，**人工神经网络模型（ANN）以0.905的测试集ROC-AUC得分大幅领先于XGBoost（0.734）和随机森林（0.725）**。这表明ANN模型在区分违约与非违约借款人方面具有显著优势，能够更好地捕捉贷款数据中的复杂非线性特征关系。

从准确率指标来看，三种模型的测试集准确率非常接近（88.87%-88.94%），均在89%左右。然而，考虑到数据集中类别不平衡的特点（非违约样本占比约80%），仅依靠准确率评估模型性能是不充分的，ROC-AUC是更为合理的综合评价指标。

从过拟合角度来看，ANN模型的训练与测试性能最为接近，泛化能力最佳；XGBoost模型略有过拟合但程度可控；随机森林模型在训练集上达到100%准确率，存在严重过拟合，需通过调整超参数（如限制树深度、增加最小叶子节点数等）加以改善。

---

## 四、总结与讨论

### 4.1 研究结论

本研究基于LendingClub平台2007年至今的贷款数据，通过系统的探索性数据分析和机器学习建模，得出以下主要结论：

**（1）贷款违约的关键影响因素**

通过探索性数据分析和特征相关性分析，本研究识别出以下影响贷款违约的关键因素：

- **贷款利率（int_rate）** 是最重要的违约预测因子，高利率贷款的违约风险显著增高。这可能是因为高利率通常对应较高的信用风险等级，且高利率增加了借款人的还款负担。
- **贷款等级（grade/sub_grade）** 与违约率高度相关。从A等级到G等级，违约率呈明显递增趋势，LendingClub的评级系统对信用风险具有良好的区分能力。
- **贷款期限（term）** 显著影响违约概率，60个月期限贷款的违约率远高于36个月期限贷款。
- **债务收入比（dti）** 与违约风险正相关，DTI较高的借款人更易违约。
- **年收入（annual_inc）** 与违约风险负相关，收入较高的借款人违约风险相对较低。
- **循环信用利用率（revol_util）** 较高的借款人违约风险更大。

这些因素可归纳为两大类：**贷款属性特征**（利率、等级、期限等）和**借款人财务状况特征**（收入、DTI、循环信用利用率等），两类特征共同决定了借款人的违约概率。

**（2）模型性能比较**

在三种预测模型中，人工神经网络（ANN）在ROC-AUC指标上显著优于XGBoost和随机森林，表明深度学习模型在处理P2P借贷数据中的复杂特征关系方面具有明显优势。具体而言：

- ANN模型的测试集ROC-AUC达到0.905，远高于XGBoost（0.734）和随机森林（0.725）；
- ANN模型的泛化能力最佳，训练集与测试集性能几乎一致；
- 随机森林模型存在严重过拟合问题；
- 三种模型在违约类（Charged Off）的召回率上均表现不足（约0.46-0.50），反映出类别不平衡对模型的影响。

**（3）类别不平衡问题**

数据集中违约样本仅占约19.62%，类别不平衡导致所有模型在识别违约借款人方面表现不佳（召回率约0.46-0.50）。虽然模型能够高准确率地识别非违约借款人（召回率约0.99），但在实际风控场景中，漏识违约借款人的代价远高于错误拒绝优质借款人，因此违约类的召回率是更需要关注的指标。

### 4.2 讨论

**（1）关于模型选择**

本研究结果表明，ANN模型在ROC-AUC指标上具有明显优势，这与前人研究中关于深度学习方法在信用评估领域优势的结论一致（Kvamme et al., 2018）。ANN模型通过多层非线性变换，能够自动学习特征间的复杂交互关系，而传统的树模型（如XGBoost和随机森林）在特征交互的自动发现方面能力有限。然而，ANN模型也存在可解释性不足的问题，在实际金融应用中可能面临监管合规方面的挑战。

值得注意的是，XGBoost和随机森林在本研究中均采用了默认或较为简单的超参数配置，未经充分调优。若通过网格搜索或贝叶斯优化等方法对超参数进行系统调优，这两种模型的性能可能会有显著提升，缩小与ANN模型的差距。

**（2）关于类别不平衡处理**

类别不平衡是本研究中影响模型性能的重要因素。未来研究可以考虑以下策略改善这一问题：
- **过采样方法：** 如SMOTE（合成少数类过采样技术）或ADASYN（自适应合成采样）；
- **欠采样方法：** 如随机欠采样或Tomek Links；
- **代价敏感学习：** 在模型训练中为不同类别设置不同的误分类权重；
- **集成不平衡学习方法：** 如BalancedRandomForest或EasyEnsemble。

**（3）关于特征工程**

本研究在特征工程方面进行了较为全面的处理，包括缺失值填充、异常值移除、特征编码和标准化等。然而，仍有以下改进空间：
- 可以考虑使用特征选择方法（如L1正则化、基于树模型的特征重要性等）筛选最具预测力的特征子集；
- 可以构造更多交互特征（如利率与贷款金额的交互项）以增强模型的表达能力；
- 可以尝试使用目标编码（Target Encoding）等更先进的类别特征编码方法。

**（4）研究局限性**

本研究存在以下局限性：
- 数据集仅包含LendingClub平台的数据，研究结论的外部有效性有待验证；
- 受限于数据可用性，未纳入宏观经济指标（如失业率、GDP增长率等）作为外部特征；
- 模型的超参数调优尚不充分，特别是XGBoost和随机森林模型；
- 未对模型的特征重要性进行深入的可解释性分析（如SHAP分析）。

### 4.3 未来研究方向

基于本研究的结论和讨论，未来研究可从以下方向进一步拓展：

1. **模型优化：** 采用系统的超参数调优方法（如贝叶斯优化），充分发挥各模型的潜力；引入更多先进的深度学习架构（如注意力机制、Transformer等）。
2. **不平衡学习：** 系统比较各种类别不平衡处理策略的效果，寻找最优的不平衡数据建模方案。
3. **可解释性分析：** 利用SHAP（SHapley Additive exPlanations）等可解释性工具，深入分析各特征对模型预测结果的贡献，增强模型的可解释性和实际应用价值。
4. **时序分析：** 结合贷款发放时间信息，分析违约模式的时间演变规律。
5. **外部数据融合：** 引入宏观经济指标、社交网络数据等外部信息，丰富特征维度，提升预测精度。

---

## 五、分析方法总结

本研究采用的数据分析方法涵盖了从数据探索到模型构建的完整流程，具体包括：

| 分析阶段 | 具体方法 | 目的 |
|----------|----------|------|
| 描述性统计分析 | 均值、中位数、标准差、频率分布等 | 了解数据基本特征 |
| 可视化分析 | 直方图、箱线图、计数图、热力图、散点图 | 直观展示数据分布与关系 |
| 相关性分析 | Pearson相关系数 | 量化变量间线性关系 |
| 缺失值处理 | 删除法、分组均值填充法 | 保证数据完整性 |
| 异常值处理 | 基于业务逻辑的规则过滤 | 减少噪声对模型的影响 |
| 特征编码 | 独热编码（One-Hot Encoding） | 将类别变量转化为数值变量 |
| 数据标准化 | MinMax归一化 | 消除特征量纲差异 |
| 分类模型 | ANN、XGBoost、随机森林 | 贷款违约预测 |
| 模型评估 | Accuracy、Precision、Recall、F1-Score、ROC-AUC、混淆矩阵 | 全面评价模型性能 |

---

## 参考文献

[1] Thomas, L.C., Edelman, D.B., Crook, J.N. Credit Scoring and Its Applications[M]. Philadelphia: SIAM, 2002.

[2] Lessmann, S., Baesens, B., Seow, H.V., Thomas, L.C. Benchmarking State-of-the-Art Classification Algorithms for Credit Scoring: An Update of Research[J]. European Journal of Operational Research, 2015, 247(1): 124-136.

[3] Xia, Y., Liu, C., Li, Y., Liu, N. A Boosted Decision Tree Approach Using Bayesian Hyper-Parameter Optimization for Credit Scoring[J]. Expert Systems with Applications, 2017, 78: 225-241.

[4] Kvamme, H., Sellereite, N., Aas, K., Sjursen, S. Predicting Mortgage Default Using Convolutional Neural Networks[J]. Expert Systems with Applications, 2018, 102: 207-217.

[5] Serrano-Cinca, C., Gutiérrez-Nieto, B. The Use of Profit Scoring as an Alternative to Credit Scoring Systems in Peer-to-Peer (P2P) Lending[J]. Decision Support Systems, 2016, 89: 113-122.

[6] Malekipirbazari, M., Aksakalli, V. Risk Assessment in Social Lending via Random Forests[J]. Expert Systems with Applications, 2015, 42(10): 4621-4631.

[7] Chen, T., Guestrin, C. XGBoost: A Scalable Tree Boosting System[C]. Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining, 2016: 785-794.

[8] Breiman, L. Random Forests[J]. Machine Learning, 2001, 45(1): 5-32.

[9] Goodfellow, I., Bengio, Y., Courville, A. Deep Learning[M]. Cambridge: MIT Press, 2016.

[10] Pedregosa, F., Varoquaux, G., Gramfort, A., et al. Scikit-learn: Machine Learning in Python[J]. Journal of Machine Learning Research, 2011, 12: 2825-2830.

[11] LendingClub Corporation. LendingClub Statistics[EB/OL]. https://www.lendingclub.com/info/statistics.action.

[12] Kaggle. All Lending Club Loan Data[EB/OL]. https://www.kaggle.com/datasets/wordsforthewise/lending-club/data.

[13] Chawla, N.V., Bowyer, K.W., Hall, L.O., Kegelmeyer, W.P. SMOTE: Synthetic Minority Over-sampling Technique[J]. Journal of Artificial Intelligence Research, 2002, 16: 321-357.

[14] He, H., Garcia, E.A. Learning from Imbalanced Data[J]. IEEE Transactions on Knowledge and Data Engineering, 2009, 21(9): 1263-1284.

[15] Lundberg, S.M., Lee, S.I. A Unified Approach to Interpreting Model Predictions[C]. Advances in Neural Information Processing Systems, 2017, 30: 4765-4774.

---

**附录：** 完整代码详见附件 `lending-club-loan-defaulters-prediction.ipynb`。
